basePath: /api
definitions:
  api.AttachmentDetail:
    properties:
      filename:
        type: string
      id:
        type: string
    type: object
  api.ErrorResponse:
    properties:
      message:
        example: error message
        type: string
    type: object
  api.MailDetail:
    properties:
      attachments:
        items:
          $ref: '#/definitions/api.AttachmentDetail'
        type: array
      content:
        type: string
    type: object
  ent.Attachment:
    properties:
      contentType:
        description: ContentType holds the value of the "contentType" field.
        type: string
      edges:
        allOf:
        - $ref: '#/definitions/ent.AttachmentEdges'
        description: |-
          Edges holds the relations/edges for other nodes in the graph.
          The values are being populated by the AttachmentQuery when eager-loading is set.
      filename:
        description: Filename holds the value of the "filename" field.
        type: string
      filepath:
        description: Filepath holds the value of the "filepath" field.
        type: string
      id:
        description: ID of the ent.
        type: string
    type: object
  ent.AttachmentEdges:
    properties:
      owner:
        allOf:
        - $ref: '#/definitions/ent.Envelope'
        description: Owner holds the value of the owner edge.
    type: object
  ent.Envelope:
    properties:
      content:
        description: Content holds the value of the "content" field.
        type: string
      created_at:
        description: CreatedAt holds the value of the "created_at" field.
        type: string
      edges:
        allOf:
        - $ref: '#/definitions/ent.EnvelopeEdges'
        description: |-
          Edges holds the relations/edges for other nodes in the graph.
          The values are being populated by the EnvelopeQuery when eager-loading is set.
      from:
        description: From holds the value of the "from" field.
        type: string
      id:
        description: ID of the ent.
        type: integer
      subject:
        description: Subject holds the value of the "subject" field.
        type: string
      to:
        description: To holds the value of the "to" field.
        type: string
    type: object
  ent.EnvelopeEdges:
    properties:
      attachments:
        description: Attachments holds the value of the attachments edge.
        items:
          $ref: '#/definitions/ent.Attachment'
        type: array
    type: object
host: localhost:3000
info:
  contact:
    name: Tmail
    url: https://github.com/sunls24/tmail
  description: |-
    API documentation for Tmail - Anonymous Temporary Email Service.
    Tmail provides a simple API to receive and manage temporary emails.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: Tmail API
  version: 2.0.0
paths:
  /domain:
    get:
      description: Returns a list of available email domain suffixes
      produces:
      - application/json
      responses:
        "200":
          description: List of available domains
          schema:
            items:
              type: string
            type: array
      summary: Get available domains
      tags:
      - Domain
  /download/{id}:
    get:
      description: Download an email attachment by its ID
      parameters:
      - description: Attachment ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/octet-stream
      responses:
        "200":
          description: Attachment file
          schema:
            type: file
        "400":
          description: Attachment not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Download attachment
      tags:
      - Email
  /fetch:
    get:
      consumes:
      - application/json
      description: Fetch all emails for a specific address. If the address is the
        admin address, returns the latest 100 emails from all addresses.
      parameters:
      - description: Email address to fetch emails for
        in: query
        name: to
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: List of emails
          schema:
            items:
              $ref: '#/definitions/ent.Envelope'
            type: array
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Fetch emails
      tags:
      - Email
  /fetch/{id}:
    get:
      consumes:
      - application/json
      description: Get the full content and attachments of a specific email
      parameters:
      - description: Email ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Email detail with content and attachments
          schema:
            $ref: '#/definitions/api.MailDetail'
        "400":
          description: Bad request or email not found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Fetch email detail
      tags:
      - Email
  /fetch/latest:
    get:
      consumes:
      - application/json
      description: Long polling endpoint to wait for new emails. Returns immediately
        if there's a new email with ID greater than the provided ID. Otherwise, waits
        up to 60 seconds for a new email.
      parameters:
      - description: Email address to watch for new emails
        in: query
        name: to
        required: true
        type: string
      - description: Last known email ID (returns emails newer than this)
        in: query
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: New email received
          schema:
            $ref: '#/definitions/ent.Envelope'
        "204":
          description: No new email within timeout period
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Long polling for new emails
      tags:
      - Email
  /report:
    post:
      consumes:
      - '*/*'
      description: Internal endpoint - Used by Cloudflare Workers to report incoming
        emails. This endpoint receives raw email data in MIME format and stores it
        in the database.
      parameters:
      - description: Recipient email address
        in: query
        name: to
        required: true
        type: string
      responses:
        "200":
          description: Email successfully stored
        "400":
          description: Failed to process email
      summary: Report incoming email
      tags:
      - Internal
swagger: "2.0"
tags:
- description: Email operations
  name: Email
- description: Domain operations
  name: Domain
- description: Internal operations (used by Cloudflare Workers)
  name: Internal
